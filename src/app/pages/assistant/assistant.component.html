<nb-layout>
  <nb-layout-column>
    <div class="assistant-page">
      <div class="assistant-container">
        <div class="header">
          <nb-icon icon="headphones-outline" class="header-icon"></nb-icon>
          <h1>Assistant Vocal Intelligent</h1>
          <p class="header-subtitle">Cr√©ez vos planifications en parlant naturellement</p>
        </div>

        <!-- Instructions et exemples -->
        <nb-card class="examples-card" *ngIf="!isListening && !userInput">
          <nb-card-header>
            <h5>üí° Exemples de commandes vocales</h5>
          </nb-card-header>
          <nb-card-body>
            <div class="examples-grid">
              <div class="example-item" (click)="userInput = 'J\'ai travaill√© sur le projet Bouachirdd pour la t√¢che reporting de 8h √† 9h avec la description mise √† jour du tableau de bord je suis en progress'">
                <nb-icon icon="clock-outline" class="example-icon"></nb-icon>
                <div class="example-text">
                  <strong>Planification simple :</strong><br>
                  "J'ai travaill√© sur le projet Bouachirdd pour la t√¢che reporting de 8h √† 9h avec la description mise √† jour du tableau de bord je suis en progress"
                </div>
              </div>
              
              <div class="example-item" (click)="userInput = 'J\'ai fait dans le projet Bouachirdd la t√¢che crud de 14h30 √† 16h00 avec la description d√©veloppement des fonctionnalit√©s CRUD termin√©'">
                <nb-icon icon="checkmark-circle-outline" class="example-icon"></nb-icon>
                <div class="example-text">
                  <strong>T√¢che termin√©e :</strong><br>
                  "J'ai fait dans le projet Bouachirdd la t√¢che crud de 14h30 √† 16h00 avec la description d√©veloppement des fonctionnalit√©s CRUD termin√©"
                </div>
              </div>
              
              <div class="example-item" (click)="userInput = 'J\'ai boss√© sur le projet Bouachirdd pour la t√¢che reporting de 9h √† 12h pour la refonte de l\'interface utilisateur'">
                <nb-icon icon="edit-outline" class="example-icon"></nb-icon>
                <div class="example-text">
                  <strong>Travail matinal :</strong><br>
                  "J'ai boss√© sur le projet Bouachirdd pour la t√¢che reporting de 9h √† 12h pour la refonte de l'interface utilisateur"
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card>

        <!-- Zone principale -->
        <nb-card>
          <nb-card-body>
            <div class="main-area" [class.listening]="isListening">
              <!-- Cercles anim√©s -->
              <div class="voice-animation" [class.active]="isListening">
                <div class="circle"></div>
                <div class="circle"></div>
                <div class="circle"></div>
              </div>

              <!-- Zone de transcription -->
              <div class="transcription-box">
                <div class="transcription-content">
                  <div class="status-indicator" *ngIf="isListening">
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                  </div>
                  
                  <!-- Champ de saisie -->
                  <div class="input-container">
                    <input type="text" 
                           nbInput 
                           fullWidth
                           placeholder="Ex: J'ai travaill√© sur le projet Bouachirdd pour la t√¢che reporting de 8h √† 9h avec la description mise √† jour du tableau de bord je suis en progress"
                           [(ngModel)]="userInput"
                           (input)="onUserInput($event)"
                           (keyup)="handleEnterKey($event)"
                           [class.listening]="isListening"
                           [disabled]="isLoading">
                    
                    <!-- Indicateur de chargement -->
                    <div class="loading-indicator" *ngIf="isLoading">
                      <nb-spinner status="primary" size="small"></nb-spinner>
                      <span>Traitement de la commande...</span>
                    </div>
                  </div>

                  <p class="interim-text" *ngIf="interimTranscription">{{ interimTranscription }}</p>
                </div>
              </div>

              <!-- Message de r√©ponse -->
              <div class="response-message" *ngIf="showResponse" [@responseAnimation]>
                <div class="message-content" [ngClass]="'message-' + responseType">
                  <nb-icon [icon]="getResponseIcon()" class="response-icon"></nb-icon>
                  <pre class="response-text">{{ responseMessage }}</pre>
                </div>
              </div>

              <!-- Boutons de contr√¥le -->
              <div class="controls">
                <button class="control-button microphone-button" 
                        [class.listening]="isListening" 
                        (click)="toggleListening()"
                        [disabled]="isLoading">
                  <nb-icon [icon]="isListening ? 'mic' : 'mic-outline'" class="mic-icon"></nb-icon>
                  <span class="ripple" *ngIf="isListening"></span>
                </button>
                
                <button class="control-button clear-button" 
                        [class.disabled]="!userInput && !interimTranscription"
                        (click)="clearTranscription()"
                        [disabled]="isLoading">
                  <nb-icon icon="trash-2-outline"></nb-icon>
                </button>
              </div>
            </div>
          </nb-card-body>
        </nb-card>
      </div>
    </div>
  </nb-layout-column>
</nb-layout> 